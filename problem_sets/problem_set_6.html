
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Problem Set 6 &#8212; QuantEcon DataScience</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/exercise.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://datascience.quantecon.org/problem_sets/problem_set_6.html" />
    <link rel="shortcut icon" href="../_static/lectures-favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/datascience-logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">QuantEcon DataScience</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../introduction/index.html">
   Introduction
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../introduction/overview.html">
     Course Description
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../introduction/getting_started.html">
     Getting Started
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../introduction/cloud_setup.html">
     Cloud Setup
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../introduction/local_install.html">
     Local Installation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../introduction/troubleshooting.html">
     Troubleshooting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python_fundamentals/index.html">
   Python Fundamentals
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_fundamentals/basics.html">
     Basics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_fundamentals/collections.html">
     Collections
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_fundamentals/control_flow.html">
     Control Flow
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python_fundamentals/functions.html">
     Functions
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../scientific/index.html">
   Scientific Computing
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/numpy_arrays.html">
     Introduction to Numpy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/plotting.html">
     Plotting
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/applied_linalg.html">
     Applied Linear Algebra
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/randomness.html">
     Randomness
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../scientific/optimization.html">
     Optimization
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../pandas/index.html">
   pandas
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/intro.html">
     Introduction
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/basics.html">
     Basic Functionality
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/the_index.html">
     The Index
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/storage_formats.html">
     Storage Formats
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/data_clean.html">
     Cleaning Data
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/reshape.html">
     Reshape
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/merge.html">
     Merge
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/groupby.html">
     GroupBy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/timeseries.html">
     Time series
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../pandas/matplotlib.html">
     Intermediate Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../applications/index.html">
   Applications
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/visualization_rules.html">
     Data Visualization: Rules and Guidelines
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/regression.html">
     Regression
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/recidivism.html">
     Case Study: Recidivism
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/maps.html">
     Mapping in Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/classification.html">
     Classification
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/working_with_text.html">
     Working with Text
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/ml_in_economics.html">
     Machine Learning in Economics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../applications/heterogeneity.html">
     Heterogeneous Effects
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/problem_sets/problem_set_6.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-1-7">
   Questions 1-7
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-1">
     Question 1
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-2">
     Question 2
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-3">
     Question 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#id1">
     Question 3
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-4">
     Question 4
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-5">
     Question 5
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-6">
     Question 6
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-7">
     Question 7
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-8">
   Questions 8
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#questions-9-10">
   Questions 9-10
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-9">
     Question 9
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#question-10">
     Question 10
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#question-11">
   Question 11
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="problem-set-6">
<h1>Problem Set 6<a class="headerlink" href="#problem-set-6" title="Permalink to this headline">¶</a></h1>
<p>See <a class="reference internal" href="../pandas/merge.html"><span class="doc">../pandas/merge</span></a>, <a class="reference internal" href="../pandas/reshape.html"><span class="doc">../pandas/reshape</span></a>, and <a class="reference internal" href="../pandas/groupby.html"><span class="doc">../pandas/groupby</span></a></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">qeds</span>

<span class="o">%</span><span class="k">matplotlib</span> inline
<span class="c1"># activate plot theme</span>
<span class="kn">import</span> <span class="nn">qeds</span>
<span class="n">qeds</span><span class="o">.</span><span class="n">themes</span><span class="o">.</span><span class="n">mpl_style</span><span class="p">();</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="questions-1-7">
<h2>Questions 1-7<a class="headerlink" href="#questions-1-7" title="Permalink to this headline">¶</a></h2>
<p>Lets start with a relatively straightforward exercise before we get to the really fun stuff.</p>
<p>The following code loads a cleaned piece of census data from Statistics Canada.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://datascience.quantecon.org/assets/data/canada_census.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CDcode</th>
      <th>Pname</th>
      <th>Population</th>
      <th>CollegeEducated</th>
      <th>PercentOwnHouse</th>
      <th>Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>Newfoundland and Labrador</td>
      <td>270350</td>
      <td>24.8</td>
      <td>74.1</td>
      <td>74676</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1002</td>
      <td>Newfoundland and Labrador</td>
      <td>20370</td>
      <td>7.5</td>
      <td>86.3</td>
      <td>60912</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1003</td>
      <td>Newfoundland and Labrador</td>
      <td>15560</td>
      <td>7.3</td>
      <td>86.0</td>
      <td>56224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1004</td>
      <td>Newfoundland and Labrador</td>
      <td>20385</td>
      <td>10.9</td>
      <td>73.7</td>
      <td>44282</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1005</td>
      <td>Newfoundland and Labrador</td>
      <td>42015</td>
      <td>17.0</td>
      <td>73.9</td>
      <td>62565</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>A <em>census division</em> is a geographical area, smaller than a Canadian province, that is used to
organize information at a slightly more granular level than by province or by city. The census
divisions are shown below.</p>
<div class="figure align-default">
<img alt="canada_censusdivision_map.png" src="https://datascience.quantecon.org/assets/_static/pandas_files/canada_censusdivisions_map.png" />
</div>
<p>The data above contains information on the population, percent of population with a college
degree, percent of population who own their house/apartment, and the median after-tax income at the
<em>census division</em> level.</p>
<p>Hint: The <code class="docutils literal notranslate"><span class="pre">groupby</span></code> is the key here.  You will need to practice different split, apply, and combine options.</p>
<div class="section" id="question-1">
<h3>Question 1<a class="headerlink" href="#question-1" title="Permalink to this headline">¶</a></h3>
<p>Assume that you have a separate data source with province codes and names.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">df_provincecodes</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
    <span class="s2">&quot;Pname&quot;</span> <span class="p">:</span> <span class="p">[</span> <span class="s1">&#39;Newfoundland and Labrador&#39;</span><span class="p">,</span> <span class="s1">&#39;Prince Edward Island&#39;</span><span class="p">,</span> <span class="s1">&#39;Nova Scotia&#39;</span><span class="p">,</span>
                <span class="s1">&#39;New Brunswick&#39;</span><span class="p">,</span> <span class="s1">&#39;Quebec&#39;</span><span class="p">,</span> <span class="s1">&#39;Ontario&#39;</span><span class="p">,</span> <span class="s1">&#39;Manitoba&#39;</span><span class="p">,</span> <span class="s1">&#39;Saskatchewan&#39;</span><span class="p">,</span>
                <span class="s1">&#39;Alberta&#39;</span><span class="p">,</span> <span class="s1">&#39;British Columbia&#39;</span><span class="p">,</span> <span class="s1">&#39;Yukon&#39;</span><span class="p">,</span> <span class="s1">&#39;Northwest Territories&#39;</span><span class="p">,</span><span class="s1">&#39;Nunavut&#39;</span><span class="p">],</span>
    <span class="s2">&quot;Code&quot;</span> <span class="p">:</span> <span class="p">[</span><span class="s1">&#39;NL&#39;</span><span class="p">,</span> <span class="s1">&#39;PE&#39;</span><span class="p">,</span> <span class="s1">&#39;NS&#39;</span><span class="p">,</span> <span class="s1">&#39;NB&#39;</span><span class="p">,</span> <span class="s1">&#39;QC&#39;</span><span class="p">,</span> <span class="s1">&#39;ON&#39;</span><span class="p">,</span> <span class="s1">&#39;MB&#39;</span><span class="p">,</span> <span class="s1">&#39;SK&#39;</span><span class="p">,</span> <span class="s1">&#39;AB&#39;</span><span class="p">,</span> <span class="s1">&#39;BC&#39;</span><span class="p">,</span> <span class="s1">&#39;YT&#39;</span><span class="p">,</span> <span class="s1">&#39;NT&#39;</span><span class="p">,</span> <span class="s1">&#39;NU&#39;</span><span class="p">]</span>
            <span class="p">})</span>
<span class="n">df_provincecodes</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Pname</th>
      <th>Code</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Newfoundland and Labrador</td>
      <td>NL</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Prince Edward Island</td>
      <td>PE</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Nova Scotia</td>
      <td>NS</td>
    </tr>
    <tr>
      <th>3</th>
      <td>New Brunswick</td>
      <td>NB</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Quebec</td>
      <td>QC</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Ontario</td>
      <td>ON</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Manitoba</td>
      <td>MB</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Saskatchewan</td>
      <td>SK</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Alberta</td>
      <td>AB</td>
    </tr>
    <tr>
      <th>9</th>
      <td>British Columbia</td>
      <td>BC</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Yukon</td>
      <td>YT</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Northwest Territories</td>
      <td>NT</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Nunavut</td>
      <td>NU</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>With this,</p>
<ol class="simple">
<li><p>Either merge or join these province codes into the census dataframe to provide province codes for each province
name. Hint: You need to figure out which “key” matches in the merge, and don’t be afraid to rename columns for convenience.</p></li>
<li><p>Drop the province names from the resulting dataframe.</p></li>
<li><p>Rename the column with the province codes to “Province”.  Hint: <code class="docutils literal notranslate"><span class="pre">.rename(columns</span> <span class="pre">=</span> <span class="pre">&lt;YOURDICTIONARY&gt;)</span></code></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>For this particular example, you could have renamed the column using <code class="docutils literal notranslate"><span class="pre">replace</span></code>. This is a good check.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://datascience.quantecon.org/assets/data/canada_census.csv&quot;</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="o">.</span><span class="n">replace</span><span class="p">({</span>
    <span class="s2">&quot;Alberta&quot;</span><span class="p">:</span> <span class="s2">&quot;AB&quot;</span><span class="p">,</span> <span class="s2">&quot;British Columbia&quot;</span><span class="p">:</span> <span class="s2">&quot;BC&quot;</span><span class="p">,</span> <span class="s2">&quot;Manitoba&quot;</span><span class="p">:</span> <span class="s2">&quot;MB&quot;</span><span class="p">,</span> <span class="s2">&quot;New Brunswick&quot;</span><span class="p">:</span> <span class="s2">&quot;NB&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Newfoundland and Labrador&quot;</span><span class="p">:</span> <span class="s2">&quot;NL&quot;</span><span class="p">,</span> <span class="s2">&quot;Northwest Territories&quot;</span><span class="p">:</span> <span class="s2">&quot;NT&quot;</span><span class="p">,</span> <span class="s2">&quot;Nova Scotia&quot;</span><span class="p">:</span> <span class="s2">&quot;NS&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Nunavut&quot;</span><span class="p">:</span> <span class="s2">&quot;NU&quot;</span><span class="p">,</span> <span class="s2">&quot;Ontario&quot;</span><span class="p">:</span> <span class="s2">&quot;ON&quot;</span><span class="p">,</span> <span class="s2">&quot;Prince Edward Island&quot;</span><span class="p">:</span> <span class="s2">&quot;PE&quot;</span><span class="p">,</span> <span class="s2">&quot;Quebec&quot;</span><span class="p">:</span> <span class="s2">&quot;QC&quot;</span><span class="p">,</span>
    <span class="s2">&quot;Saskatchewan&quot;</span><span class="p">:</span> <span class="s2">&quot;SK&quot;</span><span class="p">,</span> <span class="s2">&quot;Yukon&quot;</span><span class="p">:</span> <span class="s2">&quot;YT&quot;</span><span class="p">})</span>
<span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Pname&quot;</span> <span class="p">:</span> <span class="s2">&quot;Province&quot;</span><span class="p">})</span>
<span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CDcode</th>
      <th>Province</th>
      <th>Population</th>
      <th>CollegeEducated</th>
      <th>PercentOwnHouse</th>
      <th>Income</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1001</td>
      <td>NL</td>
      <td>270350</td>
      <td>24.8</td>
      <td>74.1</td>
      <td>74676</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1002</td>
      <td>NL</td>
      <td>20370</td>
      <td>7.5</td>
      <td>86.3</td>
      <td>60912</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1003</td>
      <td>NL</td>
      <td>15560</td>
      <td>7.3</td>
      <td>86.0</td>
      <td>56224</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1004</td>
      <td>NL</td>
      <td>20385</td>
      <td>10.9</td>
      <td>73.7</td>
      <td>44282</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1005</td>
      <td>NL</td>
      <td>42015</td>
      <td>17.0</td>
      <td>73.9</td>
      <td>62565</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<div class="section" id="question-2">
<h3>Question 2<a class="headerlink" href="#question-2" title="Permalink to this headline">¶</a></h3>
<p>Which province has the highest population? Which has the lowest?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-3">
<h3>Question 3<a class="headerlink" href="#question-3" title="Permalink to this headline">¶</a></h3>
<p>Show a bar plot and a pie plot of the province populations.  Hint: After the split-apply-combine, you can use <code class="docutils literal notranslate"><span class="pre">.plot.bar()</span></code> or <code class="docutils literal notranslate"><span class="pre">.plot.pie()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="id1">
<h3>Question 3<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Which province has the highest percent of individuals with a college education? Which has the
lowest?</p>
<p>Hint: Remember to weight this calculation by population!</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-4">
<h3>Question 4<a class="headerlink" href="#question-4" title="Permalink to this headline">¶</a></h3>
<p>What is the census division with the highest median income in each province?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-5">
<h3>Question 5<a class="headerlink" href="#question-5" title="Permalink to this headline">¶</a></h3>
<p>By province, what is the total population of census areas where more than 80 percent of the population own houses ?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-6">
<h3>Question 6<a class="headerlink" href="#question-6" title="Permalink to this headline">¶</a></h3>
<p>By province, what is the median income and average proportion of college-educated individuals in census areas
where more than 80 percent of the population own houses?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-7">
<h3>Question 7<a class="headerlink" href="#question-7" title="Permalink to this headline">¶</a></h3>
<p>Classify the census areas as low, medium, and highly-educated by using the college-educated proportions,
where “low” indicates that less than 10 percent of the area is college-educated, “medium” indicates between 10 and 20 percent is college-educated, and “high” indicates more than 20 percent.</p>
<p>Based on that classification, find the average income. Weight this average income by population for each of the low, medium, high education groups.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="questions-8">
<h2>Questions 8<a class="headerlink" href="#questions-8" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">qeds</span></code> library includes routines to simulate datasets in the
format of common sources.</p>
<p>One of these sources is <a class="reference external" href="https://www.shopify.com/">Shopify</a> – an
ecommerce platform used by many retail companies.</p>
<p>The code below will simulate a fairly large dataset that has the
properties of a Shopify order-detail report.</p>
<p>We’ll look at the data before describing the exercise.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="n">orders</span> <span class="o">=</span> <span class="n">qeds</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shopify</span><span class="o">.</span><span class="n">simulate_orders</span><span class="p">(</span><span class="mi">500000</span><span class="p">)</span>
<span class="n">orders</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>

<span class="n">orders</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/usr/share/miniconda3/envs/lecture-datascience/lib/python3.8/site-packages/qeds/data/shopify.py:288: FutureWarning: The pandas.datetime class is deprecated and will be removed from pandas in a future version. Import from datetime module instead.
  end_date = pd.datetime.now().strftime(&quot;%Y-%m-%d&quot;)
</pre></div>
</div>
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 501522 entries, 0 to 501521
Data columns (total 14 columns):
 #   Column             Non-Null Count   Dtype  
---  ------             --------------   -----  
 0   Day                501522 non-null  object 
 1   customer_type      501522 non-null  object 
 2   Customer ID        501522 non-null  int64  
 3   orders             501522 non-null  int64  
 4   total_sales        501522 non-null  float64
 5   Returns            501522 non-null  float64
 6   Ordered quantity   501522 non-null  int64  
 7   Gross sales        501522 non-null  float64
 8   Net sales          501522 non-null  float64
 9   Shipping           501522 non-null  float64
 10  Tax                501522 non-null  float64
 11  Net quantity       501522 non-null  int64  
 12  Returned quantity  501522 non-null  int64  
 13  Discounts          501522 non-null  float64
dtypes: float64(7), int64(5), object(2)
memory usage: 53.6+ MB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Day</th>
      <th>customer_type</th>
      <th>Customer ID</th>
      <th>orders</th>
      <th>total_sales</th>
      <th>Returns</th>
      <th>Ordered quantity</th>
      <th>Gross sales</th>
      <th>Net sales</th>
      <th>Shipping</th>
      <th>Tax</th>
      <th>Net quantity</th>
      <th>Returned quantity</th>
      <th>Discounts</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2018-06-14</td>
      <td>First-time</td>
      <td>7128036</td>
      <td>1</td>
      <td>52.26</td>
      <td>-0.0</td>
      <td>2</td>
      <td>52.26</td>
      <td>52.26</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>2</td>
      <td>0</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-07-06</td>
      <td>Returning</td>
      <td>6362224</td>
      <td>1</td>
      <td>500.82</td>
      <td>-0.0</td>
      <td>3</td>
      <td>434.85</td>
      <td>434.85</td>
      <td>7.99</td>
      <td>57.98</td>
      <td>3</td>
      <td>0</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2020-03-05</td>
      <td>Returning</td>
      <td>5806873</td>
      <td>1</td>
      <td>515.61</td>
      <td>-0.0</td>
      <td>10</td>
      <td>515.61</td>
      <td>515.61</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>10</td>
      <td>0</td>
      <td>-0.00</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2014-06-04</td>
      <td>First-time</td>
      <td>1180482</td>
      <td>1</td>
      <td>14.03</td>
      <td>-0.0</td>
      <td>5</td>
      <td>18.90</td>
      <td>14.03</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>5</td>
      <td>0</td>
      <td>-4.87</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2019-05-08</td>
      <td>Returning</td>
      <td>3029259</td>
      <td>1</td>
      <td>256.30</td>
      <td>-0.0</td>
      <td>7</td>
      <td>264.91</td>
      <td>256.30</td>
      <td>0.00</td>
      <td>0.00</td>
      <td>7</td>
      <td>0</td>
      <td>-8.62</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>We define a customer’s cohort as the month in which a customer placed
their first order and the customer type as an indicator of whether this
was their first order or a returning order.</p>
<p>Here’s what we want you to do:</p>
<p><strong>Want</strong>: Compute each month’s total orders, sales, and
quantities, separated by customer cohort and customer type.</p>
<p>Read that carefully one more time…</p>
<p>This exercise is a challenging one.</p>
<p>Using the <code class="docutils literal notranslate"><span class="pre">reshape</span></code> and <code class="docutils literal notranslate"><span class="pre">groupby</span></code> tools you have learned, apply the want
operator described above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
</pre></div>
</div>
</div>
</div>
<p>See below for advice on how to proceed.</p>
<p>When you are finished, you should have something that looks like this:</p>
<div class="figure align-default">
<img alt="groupby\_cohort\_analysis\_exercise\_output.png" src="https://datascience.quantecon.org/assets/_static/groupby_files/groupby_cohort_analysis_exercise_output.png" />
</div>
<p>Two notes on the table above:</p>
<p>The numbers you produce should actually be identical to those
: included in this table… Index into your answer and compare your answers
with this table to verify your progress.</p>
<ol class="simple">
<li><p>Your actual output will be much bigger – this just shows you what it might look like.</p></li>
</ol>
<p>Now, how to do it?</p>
<p>There is more than one way to code this, but here are some suggested
steps:</p>
<ol class="simple">
<li><p>Convert the <code class="docutils literal notranslate"><span class="pre">Day</span></code> column to have a <code class="docutils literal notranslate"><span class="pre">datetime</span></code> <code class="docutils literal notranslate"><span class="pre">dtype</span></code> instead
of object (Hint: use the <code class="docutils literal notranslate"><span class="pre">pd.to_datetime</span></code> function).</p></li>
<li><p>Add a new column that specifies the date associated with each
customer’s <code class="docutils literal notranslate"><span class="pre">&quot;First-time&quot;</span></code> order.</p>
<ul class="simple">
<li><p>Hint 1: You can do this with a combination of <code class="docutils literal notranslate"><span class="pre">groupby</span></code> and
<code class="docutils literal notranslate"><span class="pre">join</span></code>.</p></li>
<li><p>Hint 2: <code class="docutils literal notranslate"><span class="pre">customer_type</span></code> is always either <code class="docutils literal notranslate"><span class="pre">Returning</span></code> or
<code class="docutils literal notranslate"><span class="pre">First-time</span></code>.</p></li>
<li><p>Hint 3: Some customers don’t have a
<code class="docutils literal notranslate"><span class="pre">customer_type</span> <span class="pre">==</span> <span class="pre">&quot;First-time&quot;</span></code> entry. For these customers, you need to set their
values to some date that precedes the
sample’s dates. After adding valid data back into <code class="docutils literal notranslate"><span class="pre">orders</span></code> DataFrame,
you can identify the customers who don’t have a <code class="docutils literal notranslate"><span class="pre">&quot;First-Time&quot;</span></code>
entry by checking the new column for missing data.</p></li>
</ul>
</li>
<li><p>You need to group by three things.</p></li>
<li><p>You can apply one of the built-in aggregation functions to the GroupBy.</p></li>
<li><p>After the aggregation, you need to use your reshaping skills to
move things to the proper rows and columns.</p></li>
</ol>
<p>Good luck!</p>
</div>
<div class="section" id="questions-9-10">
<h2>Questions 9-10<a class="headerlink" href="#questions-9-10" title="Permalink to this headline">¶</a></h2>
<p>Let’s look at another example.</p>
<p>This time, we will use a dataset from the <a class="reference external" href="https://www.transtats.bts.gov/DL_SelectFields.asp?Table_ID=236&amp;DB_Short_Name=On-Time">Bureau of Transportation
Statistics</a>
that describes the cause for all US domestic flight delays in November 2016:</p>
<p>Loading this dataset the first time will take a minute or two because it is quite hefty… We recommend taking a break to view this <a class="reference external" href="https://xkcd.com/303/">xkcd comic</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_perf</span> <span class="o">=</span> <span class="n">qeds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;airline_performance_dec16&quot;</span><span class="p">)[[</span><span class="s2">&quot;CRSDepTime&quot;</span><span class="p">,</span> <span class="s2">&quot;Carrier&quot;</span><span class="p">,</span> <span class="s2">&quot;CarrierDelay&quot;</span><span class="p">,</span> <span class="s2">&quot;ArrDelay&quot;</span><span class="p">]]</span>
<span class="n">air_perf</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">air_perf</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 460949 entries, 0 to 460948
Data columns (total 4 columns):
 #   Column        Non-Null Count   Dtype         
---  ------        --------------   -----         
 0   CRSDepTime    460949 non-null  datetime64[ns]
 1   Carrier       460949 non-null  object        
 2   CarrierDelay  460949 non-null  float64       
 3   ArrDelay      452229 non-null  float64       
dtypes: datetime64[ns](1), float64(2), object(1)
memory usage: 14.1+ MB
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>CRSDepTime</th>
      <th>Carrier</th>
      <th>CarrierDelay</th>
      <th>ArrDelay</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2016-12-18 15:58:00</td>
      <td>AA</td>
      <td>0.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2016-12-19 15:58:00</td>
      <td>AA</td>
      <td>0.0</td>
      <td>20.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2016-12-20 15:58:00</td>
      <td>AA</td>
      <td>0.0</td>
      <td>-3.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2016-12-21 15:58:00</td>
      <td>AA</td>
      <td>0.0</td>
      <td>-10.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2016-12-22 15:58:00</td>
      <td>AA</td>
      <td>0.0</td>
      <td>-8.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">Carrier</span></code> column identifies the airline while the <code class="docutils literal notranslate"><span class="pre">CarrierDelay</span></code>
reports the total delay, in minutes, that was the “carrier’s fault”.</p>
<div class="section" id="question-9">
<h3>Question 9<a class="headerlink" href="#question-9" title="Permalink to this headline">¶</a></h3>
<p>Determine the 10 airlines which, on average, contribute most to delays.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
<span class="c1"># avg_delays =</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="question-10">
<h3>Question 10<a class="headerlink" href="#question-10" title="Permalink to this headline">¶</a></h3>
<p>One issue with this dataset is that we might not know what all those two letter carrier codes are!</p>
<p>Thankfully, we have a second dataset that maps two-letter codes
to full airline names:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">carrier_code</span> <span class="o">=</span> <span class="n">qeds</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;airline_carrier_codes&quot;</span><span class="p">)</span>
<span class="n">carrier_code</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Description</th>
    </tr>
    <tr>
      <th>Code</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>ZW</th>
      <td>Air Wisconsin Airlines Corp (1994 - )</td>
    </tr>
    <tr>
      <th>ZX</th>
      <td>Airbc Ltd. (1990 - 2000)</td>
    </tr>
    <tr>
      <th>ZX</th>
      <td>Air Georgian (2002 - )</td>
    </tr>
    <tr>
      <th>ZY</th>
      <td>Atlantic Gulf Airlines (1985 - 1986)</td>
    </tr>
    <tr>
      <th>ZYZ</th>
      <td>Skyway Aviation Inc. (1960 - 2002)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>In this question, you should merge the carrier codes and the previously computed dataframe from Question 9 (the 10 airlines that contribute most to delays).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Your code here</span>
<span class="c1"># avg_delays_w_name</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="question-11">
<h2>Question 11<a class="headerlink" href="#question-11" title="Permalink to this headline">¶</a></h2>
<p>In this question, we will load data from the World Bank. World Bank data is often stored in formats containing vestigial columns because of their data format standardization.</p>
<p>This particular data contains the world’s age dependency ratios (old) across countries. The ratio is the number of people who are
above 65 divided by the number of people between 16 and 65 and measures how many working
individuals exist relative to the number of dependent (retired) individuals.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">adr</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;https://datascience.quantecon.org/assets/data/WorldBank_AgeDependencyRatio.csv&quot;</span><span class="p">)</span>
<span class="n">adr</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Series Name</th>
      <th>Series Code</th>
      <th>Country Name</th>
      <th>Country Code</th>
      <th>1960</th>
      <th>1970</th>
      <th>1980</th>
      <th>1990</th>
      <th>2000</th>
      <th>2010</th>
      <th>2017</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Age dependency ratio, old (% of working-age po...</td>
      <td>SP.POP.DPND.OL</td>
      <td>Belgium</td>
      <td>BEL</td>
      <td>18.376221914997</td>
      <td>21.3310651174022</td>
      <td>22.0827795865161</td>
      <td>22.3478876919412</td>
      <td>25.7237772053865</td>
      <td>26.3502220937405</td>
      <td>28.8663095376732</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Age dependency ratio, old (% of working-age po...</td>
      <td>SP.POP.DPND.OL</td>
      <td>High income</td>
      <td>HIC</td>
      <td>13.7442735255142</td>
      <td>15.5128071607608</td>
      <td>17.2793259853973</td>
      <td>18.1810594950547</td>
      <td>20.238646358909</td>
      <td>22.5821690792651</td>
      <td>26.5545126329423</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Age dependency ratio, old (% of working-age po...</td>
      <td>SP.POP.DPND.OL</td>
      <td>Andorra</td>
      <td>AND</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Age dependency ratio, old (% of working-age po...</td>
      <td>SP.POP.DPND.OL</td>
      <td>Austria</td>
      <td>AUT</td>
      <td>18.5196085788113</td>
      <td>22.7370767160537</td>
      <td>23.6381357233154</td>
      <td>21.8956152694877</td>
      <td>22.7046805297879</td>
      <td>26.373860988558</td>
      <td>28.7849528312483</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Age dependency ratio, old (% of working-age po...</td>
      <td>SP.POP.DPND.OL</td>
      <td>Bermuda</td>
      <td>BMU</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
      <td>..</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>This data only has a single variable, so you can eliminate the <code class="docutils literal notranslate"><span class="pre">Series</span> <span class="pre">Name</span></code> and <code class="docutils literal notranslate"><span class="pre">Series</span> <span class="pre">Code</span></code>
columns. You can also eliminate the <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Code</span></code> or  <code class="docutils literal notranslate"><span class="pre">Country</span> <span class="pre">Name</span></code> column (but not both),
since they contain repetitive information.</p>
<p>We can organize this data in a couple of ways.</p>
<p>The first (and the one we’d usually choose) is to place the years and country names on the index and
have a single column. (If we had more variables, each variable could have its own column.)</p>
<p>Another reasonable organization is to have one country per column and place the years on the index.</p>
<p>Your goal is to reshape the data both ways. Which is easier? Which do you
think a better organization method?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reshape to have years and countries on index</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Reshape to have years on index and country identifiers as columns</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./problem_sets"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Chase Coleman, Spencer Lyon, and Jesse Perla<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>